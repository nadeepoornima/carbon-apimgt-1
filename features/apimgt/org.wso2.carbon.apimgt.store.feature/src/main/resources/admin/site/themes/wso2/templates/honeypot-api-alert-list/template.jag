<% jagg.template("honeypot-api-alert-list", function(inputs, outputs, jagg) { %>

<div id="listing">
    <div class="page-header">
        <h2>Honeypot API Alert List</h2>
    </div>
    <div class="content-section shadow-up">
    <div class="content-data">

    <%var log = new Log();
      new Log('test').info(outputs);
    if(outputs.alertData.size()) { %>
    <table class="table table-responsive table-striped" >
        <thead>
            <tr>
                <th class=""><b>Record Time</b></th>
                <th class=""><b>Message ID<b></th>
                <th class=""><b>API Method</b></th>
                <th class=""><b>Headers Set</b></th>
                <th class=""><b>Message Body</b></th>
                <th class=""><b>Client IP</b></th>
                <th class=""><b>Remove</b></th>
            </tr>
        </thead>

       <%
         var log = new Log();
         var ArrayList = Packages.java.util.ArrayList;
         var alertInfo = outputs.alertData;
         var AlertData =  Packages.org.wso2.carbon.apimgt.api.model.honeypotAPI.HoneyPotAPIAlertData;
         var alertData = new AlertData();

        for(i=0; i < alertInfo.size(); i++) {
            alertData = alertInfo.get(i);
            var time = alertData.getCurrentTime();
            var recordTime = new Date(time).toLocaleString();
        %>

        <tr>

            <td><b><%print(recordTime);%></b></td>
            <td><%print(alertData.getMessageID());%></td>
            <td><%print(alertData.getApiMethod());%></td>
            <td><%print(alertData.getHeaderSet());%></td>
            <td><%print(alertData.getMessageBody());%></td>
            <td><%print(alertData.getClientIp());%></td>
            <td class="text-right">
            <a id="deleteButton" onclick="deleteAlert('<%=alertData.getMessageID()%>')" class="btn padding-reduce-on-grid-view">
                    <span class="fw-stack">
                        <i class="fw fw-circle-outline fw-stack-2x"></i>
                        <i class="fw fw-delete fw-stack-1x"></i>
                    </span>
                    <span class="hidden-xs"><%=i18n.localize("Delete")%></span>
                </a>
            </td>
         </tr>
         <%}%>
    </table>
    <%} else {%>
    <div class="message message-info">
   	    <h4><i class="icon fw fw-info"></i><%=i18n.localize("Microgateways are not defined")%></h4>
   		<p><%=i18n.localize("Microgateways are not defined")%></p>
   	</div>
   <% }%>

    </div>
    </div>
</div>
<% }); %>